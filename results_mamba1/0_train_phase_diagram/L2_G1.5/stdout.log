Configuration saved to results/0_train_phase_diagram/L2_G1.5/config.json
Using device: cuda
Creating datasets...
Train dataset size: 300000
Eval dataset size: 1800
Creating model: MambaForComposite
Model parameters: 66,272

Starting training for 200 epochs...
Epoch 1/200 | Loss: 4.6051 | LR: 0.000010
Epoch 2/200 | Loss: 4.5960 | LR: 0.000034
Epoch 3/200 | Loss: 4.5685 | LR: 0.000058
Epoch 4/200 | Loss: 4.5580 | LR: 0.000082
Epoch 5/200 | Loss: 4.5253 | LR: 0.000106
Epoch 6/200 | Loss: 4.5062 | LR: 0.000130
Epoch 7/200 | Loss: 4.5002 | LR: 0.000154
Epoch 8/200 | Loss: 4.4954 | LR: 0.000178
Epoch 9/200 | Loss: 4.4897 | LR: 0.000202
Epoch 10/200 | Loss: 4.4801 | Comp Acc: 0.0022 (best: 0.0022@10) | Sym Acc: 0.0200 (best: 0.0200@10) | LR: 0.000226
Epoch 11/200 | Loss: 4.4330 | LR: 0.000250
Epoch 12/200 | Loss: 4.2225 | LR: 0.000250
Epoch 13/200 | Loss: 3.9890 | LR: 0.000250
Epoch 14/200 | Loss: 3.7593 | LR: 0.000250
Epoch 15/200 | Loss: 3.5191 | LR: 0.000250
Epoch 16/200 | Loss: 3.3668 | LR: 0.000250
Epoch 17/200 | Loss: 3.2545 | LR: 0.000249
Epoch 18/200 | Loss: 3.1662 | LR: 0.000249
Epoch 19/200 | Loss: 3.0839 | LR: 0.000249
Epoch 20/200 | Loss: 3.0214 | Comp Acc: 0.1467 (best: 0.1467@20) | Sym Acc: 0.0500 (best: 0.0500@20) | LR: 0.000249
Epoch 21/200 | Loss: 2.9431 | LR: 0.000248
Epoch 22/200 | Loss: 2.9101 | LR: 0.000248
Epoch 23/200 | Loss: 2.8466 | LR: 0.000248
Epoch 24/200 | Loss: 2.7933 | LR: 0.000247
Epoch 25/200 | Loss: 2.7621 | LR: 0.000247
Epoch 26/200 | Loss: 2.7221 | LR: 0.000246
Epoch 27/200 | Loss: 2.7024 | LR: 0.000246
Epoch 28/200 | Loss: 2.6838 | LR: 0.000245
Epoch 29/200 | Loss: 2.6629 | LR: 0.000245
Epoch 30/200 | Loss: 2.6300 | Comp Acc: 0.0794 (best: 0.1467@20) | Sym Acc: 0.0256 (best: 0.0500@20) | LR: 0.000244
Epoch 31/200 | Loss: 2.6067 | LR: 0.000243
Epoch 32/200 | Loss: 2.5827 | LR: 0.000243
Epoch 33/200 | Loss: 2.5546 | LR: 0.000242
Epoch 34/200 | Loss: 2.5324 | LR: 0.000241
Epoch 35/200 | Loss: 2.5151 | LR: 0.000241
Epoch 36/200 | Loss: 2.4933 | LR: 0.000240
Epoch 37/200 | Loss: 2.4842 | LR: 0.000239
Epoch 38/200 | Loss: 2.4615 | LR: 0.000238
Epoch 39/200 | Loss: 2.4450 | LR: 0.000237
Epoch 40/200 | Loss: 2.4315 | Comp Acc: 0.1367 (best: 0.1467@20) | Sym Acc: 0.0250 (best: 0.0500@20) | LR: 0.000236
Epoch 41/200 | Loss: 2.4112 | LR: 0.000236
Epoch 42/200 | Loss: 2.3842 | LR: 0.000235
Epoch 43/200 | Loss: 2.3647 | LR: 0.000234
Epoch 44/200 | Loss: 2.3453 | LR: 0.000233
Epoch 45/200 | Loss: 2.3269 | LR: 0.000232
Epoch 46/200 | Loss: 2.3095 | LR: 0.000230
Epoch 47/200 | Loss: 2.2891 | LR: 0.000229
Epoch 48/200 | Loss: 2.2775 | LR: 0.000228
Epoch 49/200 | Loss: 2.2556 | LR: 0.000227
Epoch 50/200 | Loss: 2.2435 | Comp Acc: 0.2506 (best: 0.2506@50) | Sym Acc: 0.0383 (best: 0.0500@20) | LR: 0.000226
Epoch 51/200 | Loss: 2.2293 | LR: 0.000225
Epoch 52/200 | Loss: 2.2117 | LR: 0.000223
Epoch 53/200 | Loss: 2.1870 | LR: 0.000222
Epoch 54/200 | Loss: 2.1795 | LR: 0.000221
Epoch 55/200 | Loss: 2.1598 | LR: 0.000220
Epoch 56/200 | Loss: 2.1382 | LR: 0.000218
Epoch 57/200 | Loss: 2.1304 | LR: 0.000217
Epoch 58/200 | Loss: 2.1055 | LR: 0.000216
Epoch 59/200 | Loss: 2.0881 | LR: 0.000214
Epoch 60/200 | Loss: 2.0707 | Comp Acc: 0.2861 (best: 0.2861@60) | Sym Acc: 0.0211 (best: 0.0500@20) | LR: 0.000213
Epoch 61/200 | Loss: 2.0549 | LR: 0.000211
Epoch 62/200 | Loss: 2.0361 | LR: 0.000210
Epoch 63/200 | Loss: 2.0183 | LR: 0.000208
Epoch 64/200 | Loss: 2.0024 | LR: 0.000207
Epoch 65/200 | Loss: 1.9785 | LR: 0.000205
Epoch 66/200 | Loss: 1.9551 | LR: 0.000204
Epoch 67/200 | Loss: 1.9350 | LR: 0.000202
Epoch 68/200 | Loss: 1.9155 | LR: 0.000201
Epoch 69/200 | Loss: 1.8961 | LR: 0.000199
Epoch 70/200 | Loss: 1.8767 | Comp Acc: 0.3250 (best: 0.3250@70) | Sym Acc: 0.0322 (best: 0.0500@20) | LR: 0.000197
Epoch 71/200 | Loss: 1.8577 | LR: 0.000196
Epoch 72/200 | Loss: 1.8389 | LR: 0.000194
Epoch 73/200 | Loss: 1.8201 | LR: 0.000192
Epoch 74/200 | Loss: 1.8016 | LR: 0.000191
Epoch 75/200 | Loss: 1.7853 | LR: 0.000189
Epoch 76/200 | Loss: 1.7755 | LR: 0.000187
Epoch 77/200 | Loss: 1.7454 | LR: 0.000185
Epoch 78/200 | Loss: 1.7341 | LR: 0.000184
Epoch 79/200 | Loss: 1.7109 | LR: 0.000182
Epoch 80/200 | Loss: 1.6879 | Comp Acc: 0.4267 (best: 0.4267@80) | Sym Acc: 0.0189 (best: 0.0500@20) | LR: 0.000180
Epoch 81/200 | Loss: 1.6717 | LR: 0.000178
Epoch 82/200 | Loss: 1.6549 | LR: 0.000176
Epoch 83/200 | Loss: 1.6380 | LR: 0.000175
Epoch 84/200 | Loss: 1.6214 | LR: 0.000173
Epoch 85/200 | Loss: 1.6062 | LR: 0.000171
Epoch 86/200 | Loss: 1.5910 | LR: 0.000169
Epoch 87/200 | Loss: 1.5756 | LR: 0.000167
Epoch 88/200 | Loss: 1.5685 | LR: 0.000165
Epoch 89/200 | Loss: 1.5473 | LR: 0.000163
Epoch 90/200 | Loss: 1.5368 | Comp Acc: 0.3883 (best: 0.4267@80) | Sym Acc: 0.0289 (best: 0.0500@20) | LR: 0.000161
Epoch 91/200 | Loss: 1.5163 | LR: 0.000159
Epoch 92/200 | Loss: 1.5076 | LR: 0.000158
Epoch 93/200 | Loss: 1.4864 | LR: 0.000156
Epoch 94/200 | Loss: 1.4737 | LR: 0.000154
Epoch 95/200 | Loss: 1.4603 | LR: 0.000152
Epoch 96/200 | Loss: 1.4477 | LR: 0.000150
Epoch 97/200 | Loss: 1.4343 | LR: 0.000148
Epoch 98/200 | Loss: 1.4202 | LR: 0.000146
Epoch 99/200 | Loss: 1.4103 | LR: 0.000144
Epoch 100/200 | Loss: 1.4073 | Comp Acc: 0.4356 (best: 0.4356@100) | Sym Acc: 0.0333 (best: 0.0500@20) | LR: 0.000142
Epoch 101/200 | Loss: 1.3793 | LR: 0.000140
Epoch 102/200 | Loss: 1.3676 | LR: 0.000138
Epoch 103/200 | Loss: 1.3711 | LR: 0.000136
Epoch 104/200 | Loss: 1.3641 | LR: 0.000134
Epoch 105/200 | Loss: 1.3585 | LR: 0.000132
Epoch 106/200 | Loss: 1.3460 | LR: 0.000130
Epoch 107/200 | Loss: 1.3360 | LR: 0.000128
Epoch 108/200 | Loss: 1.3282 | LR: 0.000126
Epoch 109/200 | Loss: 1.3112 | LR: 0.000124
Epoch 110/200 | Loss: 1.3057 | Comp Acc: 0.4411 (best: 0.4411@110) | Sym Acc: 0.0156 (best: 0.0500@20) | LR: 0.000122
Epoch 111/200 | Loss: 1.2928 | LR: 0.000120
Epoch 112/200 | Loss: 1.2854 | LR: 0.000118
Epoch 113/200 | Loss: 1.2772 | LR: 0.000116
Epoch 114/200 | Loss: 1.2700 | LR: 0.000114
Epoch 115/200 | Loss: 1.2613 | LR: 0.000112
Epoch 116/200 | Loss: 1.2531 | LR: 0.000110
Epoch 117/200 | Loss: 1.2402 | LR: 0.000108
Epoch 118/200 | Loss: 1.2195 | LR: 0.000106
Epoch 119/200 | Loss: 1.2053 | LR: 0.000104
Epoch 120/200 | Loss: 1.1953 | Comp Acc: 0.3917 (best: 0.4411@110) | Sym Acc: 0.0006 (best: 0.0500@20) | LR: 0.000102
Epoch 121/200 | Loss: 1.1874 | LR: 0.000101
Epoch 122/200 | Loss: 1.1787 | LR: 0.000099
Epoch 123/200 | Loss: 1.1699 | LR: 0.000097
Epoch 124/200 | Loss: 1.1601 | LR: 0.000095
Epoch 125/200 | Loss: 1.1500 | LR: 0.000093
Epoch 126/200 | Loss: 1.1342 | LR: 0.000091
Epoch 127/200 | Loss: 1.1341 | LR: 0.000089
Epoch 128/200 | Loss: 1.1141 | LR: 0.000087
Epoch 129/200 | Loss: 1.1049 | LR: 0.000085
Epoch 130/200 | Loss: 1.0865 | Comp Acc: 0.4311 (best: 0.4411@110) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000084
Epoch 131/200 | Loss: 1.0767 | LR: 0.000082
Epoch 132/200 | Loss: 1.0582 | LR: 0.000080
Epoch 133/200 | Loss: 1.0470 | LR: 0.000078
Epoch 134/200 | Loss: 1.0429 | LR: 0.000076
Epoch 135/200 | Loss: 1.0365 | LR: 0.000075
Epoch 136/200 | Loss: 1.0295 | LR: 0.000073
Epoch 137/200 | Loss: 1.0236 | LR: 0.000071
Epoch 138/200 | Loss: 1.0173 | LR: 0.000069
Epoch 139/200 | Loss: 1.0092 | LR: 0.000068
Epoch 140/200 | Loss: 0.9986 | Comp Acc: 0.5289 (best: 0.5289@140) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000066
Epoch 141/200 | Loss: 0.9870 | LR: 0.000064
Epoch 142/200 | Loss: 0.9794 | LR: 0.000063
Epoch 143/200 | Loss: 0.9723 | LR: 0.000061
Epoch 144/200 | Loss: 0.9632 | LR: 0.000059
Epoch 145/200 | Loss: 0.9525 | LR: 0.000058
Epoch 146/200 | Loss: 0.9452 | LR: 0.000056
Epoch 147/200 | Loss: 0.9390 | LR: 0.000055
Epoch 148/200 | Loss: 0.9331 | LR: 0.000053
Epoch 149/200 | Loss: 0.9225 | LR: 0.000052
Epoch 150/200 | Loss: 0.9131 | Comp Acc: 0.5189 (best: 0.5289@140) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000050
Epoch 151/200 | Loss: 0.9053 | LR: 0.000049
Epoch 152/200 | Loss: 0.8959 | LR: 0.000047
Epoch 153/200 | Loss: 0.8855 | LR: 0.000046
Epoch 154/200 | Loss: 0.8793 | LR: 0.000044
Epoch 155/200 | Loss: 0.8708 | LR: 0.000043
Epoch 156/200 | Loss: 0.8666 | LR: 0.000042
Epoch 157/200 | Loss: 0.8594 | LR: 0.000040
Epoch 158/200 | Loss: 0.8527 | LR: 0.000039
Epoch 159/200 | Loss: 0.8463 | LR: 0.000038
Epoch 160/200 | Loss: 0.8404 | Comp Acc: 0.6172 (best: 0.6172@160) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000037
Epoch 161/200 | Loss: 0.8349 | LR: 0.000035
Epoch 162/200 | Loss: 0.8291 | LR: 0.000034
Epoch 163/200 | Loss: 0.8239 | LR: 0.000033
Epoch 164/200 | Loss: 0.8187 | LR: 0.000032
Epoch 165/200 | Loss: 0.8145 | LR: 0.000031
Epoch 166/200 | Loss: 0.8085 | LR: 0.000030
Epoch 167/200 | Loss: 0.8034 | LR: 0.000028
Epoch 168/200 | Loss: 0.8003 | LR: 0.000027
Epoch 169/200 | Loss: 0.7974 | LR: 0.000026
Epoch 170/200 | Loss: 0.7914 | Comp Acc: 0.6117 (best: 0.6172@160) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000025
Epoch 171/200 | Loss: 0.7865 | LR: 0.000024
Epoch 172/200 | Loss: 0.7826 | LR: 0.000024
Epoch 173/200 | Loss: 0.7789 | LR: 0.000023
Epoch 174/200 | Loss: 0.7751 | LR: 0.000022
Epoch 175/200 | Loss: 0.7709 | LR: 0.000021
Epoch 176/200 | Loss: 0.7670 | LR: 0.000020
Epoch 177/200 | Loss: 0.7635 | LR: 0.000019
Epoch 178/200 | Loss: 0.7599 | LR: 0.000019
Epoch 179/200 | Loss: 0.7570 | LR: 0.000018
Epoch 180/200 | Loss: 0.7533 | Comp Acc: 0.6106 (best: 0.6172@160) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000017
Epoch 181/200 | Loss: 0.7507 | LR: 0.000017
Epoch 182/200 | Loss: 0.7475 | LR: 0.000016
Epoch 183/200 | Loss: 0.7450 | LR: 0.000015
Epoch 184/200 | Loss: 0.7419 | LR: 0.000015
Epoch 185/200 | Loss: 0.7396 | LR: 0.000014
Epoch 186/200 | Loss: 0.7375 | LR: 0.000014
Epoch 187/200 | Loss: 0.7353 | LR: 0.000013
Epoch 188/200 | Loss: 0.7328 | LR: 0.000013
Epoch 189/200 | Loss: 0.7306 | LR: 0.000012
Epoch 190/200 | Loss: 0.7283 | Comp Acc: 0.6328 (best: 0.6328@190) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000012
Epoch 191/200 | Loss: 0.7262 | LR: 0.000012
Epoch 192/200 | Loss: 0.7238 | LR: 0.000011
Epoch 193/200 | Loss: 0.7220 | LR: 0.000011
Epoch 194/200 | Loss: 0.7198 | LR: 0.000011
Epoch 195/200 | Loss: 0.7177 | LR: 0.000011
Epoch 196/200 | Loss: 0.7162 | LR: 0.000010
Epoch 197/200 | Loss: 0.7139 | LR: 0.000010
Epoch 198/200 | Loss: 0.7122 | LR: 0.000010
Epoch 199/200 | Loss: 0.7108 | LR: 0.000010
Epoch 200/200 | Loss: 0.7090 | Comp Acc: 0.6494 (best: 0.6494@200) | Sym Acc: 0.0000 (best: 0.0500@20) | LR: 0.000010

Training finished at epoch 200.
Best Composite Accuracy: 0.6494 (epoch 200)
Best Symmetric Accuracy: 0.0500 (epoch 20)
Metrics saved to results/0_train_phase_diagram/L2_G1.5/metrics.json

Training completed successfully!
